{% extends "base.html" %}
{% load i18n %}

{% block head %}
    <title>{% trans "Edit configuration" %}</title>
{% endblock head %}


{% block content %}
    <small>Editing [{{ entity.cid }}.{{ entity.id }}]</small> <b>{{ entity.getTitle }}</b>
    <form method="POST" action="">
        {% csrf_token %}
        {{ form.non_field_errors }}
        <table cellspacing="10">
            {% for field in form %}
                <tr>
                    <td>
                        <font size='2'>
                            {{ field.label_tag }}:
                        </font>
                    </td>
                    <td> {{ field }}
                    {% if field.errors %}
                        {{ field.errors }}
                    {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </table>

        Relations:
        <table cellspacing="10">
        {% for relation_info in relations_infos %}
            <tr>
                <td style="background-color: #90ee90; padding: 5px;">
                    <b>{{ relation_info.title }}</b>
                </td>
                <td width="550px;">
                    {% for relation in relation_info.relations %}
                        {% if relation %}
                        <div style='background-color: #e1e1e1; width:100px; float:left; padding:2px; margin: 1px; border: 1px gray solid;'>
                            <div style="float: right;">
                                <font size='1'>
                                    <a onclick="return confirm('Are you sure you want to delete relation {{ relation.role }} {{ relation.title }}?')" href="{% url std-editor-delete-relation relation.cid relation.id %}?next={{ request.get_full_path|urlencode }}">X</a>
                                </font>
                            </div>
                            <a href="{% url std-editor-edit-instance relation.other_cid relation.other_id %}" style="text-decoration: none; color: #000000;">
                                <font size='1'>
                                    {{ relation.role }}
                                </font>
                                <font size='1'>
                                    <span style='background-color: yellow; padding:1px 2px; margin: 1px; border: 1px gray solid;'><b>{{ relation.class_name }}</b></span>
                                </font>
                                <font size='2'>
                                    {{ relation.title }}
                                </font>
                            </a>
                        </div>
                        {% else %}
                            <div style="clear: both; height: 10px;">&nbsp;</div>
                        {% endif %}
                    {% endfor %}
                    <div style="clear: both;" />
                    <table>
                    {% for allowed_neighbour in relation_info.allowed_neighbours %}
                        <tr>
                            <td>
                                <font size='2'>
                                    <span style="font-size: larger; font-weight: 900; color:green;"><b>+</b></span> new relation {{ allowed_neighbour.title }}:
                                </font>
                            </td>
                            <td>
                                {{ allowed_neighbour.input_widget }}
                            </td>
                        </tr>
                    {% endfor %}
                    </table>
                </td>
            </tr>
        {% endfor %}
        </table>
        <input name="save" type="submit" value="Save">
        <input name="save_and_return" type="submit" value="Save and return">
        <a href="{% url std-editor-delete-instance entity.cid entity.id %}"  onclick="return confirm('Are you sure you want to delete entity {{ entity.getTitle }}?')">Delete</a>
    </form>

    <hr>
{% endblock content %}